GENERAL

VISIBILIDAD DE LAS CLASES PUBLICAS >>>> REVISAR <<<<

--------------------------------------------------------------------
BANK ACCOUNTS

Unit testing:

- Si hay tiempo, al final, hacer que, ante un CCC o IBAN erroneo se presente una excepción,
 en vez de, simplemente, debolver nulo.


---------------------------------------------------------------------
INVOICES

Invoice
¿Como anulamos una factura?¿Factura de valor negativo?
¿Como anulamos un bill?

Facturas pro-forma
 - (otro invoice ID con otro contador)

 
UnitTest:
- Lanzar excepcion si lista de transacciones es cero
- Lanzar excepcion si transacciones tienen valores negativos(?)
- ¿Se permiten transacciones negativas?


----------------------------------------------------------------------
BILLING
 - Estado de las 'Bill':
     * Al cobro: La fecha de vencimiento aún no ha pasado
	 * Pagada
	 * Impagada: Sigue intentando cobrarse
		* La fecha de vencimiento ha pasado
		* La factura ha venido devuenta del banco
	 * Anulada: Se ha anulado por cualquier razón. 
	 * Fallida: 
 - Una factura puede tener 'additional charges' debido, por ejemplo, a devoluciones bancarias

Aceptaciones:
 
 Geherar un bill
 - Dado un servicio, se genera una factura y se crea un bill, forma de pago: en caja
 
 Cobrar un bill (por caja)
 - Cuando el socio paga el recibo por caja
 - El recibo aparece como pagado
 - El Definitive Payment Method es por caja, y se registra la fecha del pago
 - Aparte se registra la fecha de pago en el 'bill' (payment date)?
 - Como es el ultimo recibo, la factura aparecerá como pagada, con fecha la del último bill
 
 Cobrar un bill (por remesa)
 
 Cobrar un bill (por cheque)
 
 Cobrar un bill (transferencia recibida)
 
 Anular un bill
 
 Renegociar un bill 
  
UnitTest
 - Que coincidan las que entran con las que salen al renegociar las bill

----------------------------------------------------------------------

DOMICILIACIONES

Un miembro tiene

 - Un lista de cuentas bancarias
 - Una lista de domiciliaciones
 - Si añadimos una domiciliacion nueva sin que la cuenta este dada de alta, se la añadimos

-----------------------------------------------------------------------
REMESAS










-------------------------------------------------------------------------------------------------
User stories

 - Features Domiciliaciones
  Given El último numero de referencia
  Given El miembro
  Given una serie de cuetas con su numero de referencia (domicliaciones)
  
  Scenario: Añadir un nuevo numero de cuenta
  
 - Features Billing
  - Un Member tiene un tipo de PaymentMethod definido
  - Podemos cambiar el default Payment Method de un miembro
  - Podemos añadir una nueva domiciliacion a la lista de domiciliaciones del socio
  - Podemos quitar una domiciliacion de la lista de domiciliaciones del socio
  
  - al añadir un bill este se crea SIN payment method definido
  - Podemos asignar al recibo uno de los payments methods del socio (que un recibo vaya a una cuenta en particular)
  - Un bill es pagado -> en ese momento se le asocia el payment method utilizado
  - Un bill es anulado
  - Cuando el último bill es pagado -> factura pagada
  - Cuando el último bill es anulado -> si hubo pagos la factura es pagada, si todos los bill estaban anulados
  
 - Features invoices
  - Cuando un invoice es cancelled todos los pagos restantes son cancelled
  - Cuando un invoice es dado por uncollectible todos los pagos restantes son dados por uncollectible
 
 - Features Servicios
  - Anadir un servicio
  - Suscribir a un miembro a un servicio - > asociarle un payment method
  
 ---------------------------------------------------------------------------------------------------------
Bill Unit Testing
 - La lista de Bills asociada a unninvoice es accesible (tiene un 'get')
 - Si es un nuevo 'Bill' ID del bill lom calcula la clase invoice al añadir el bill al invoice
 - Un bill puede ser creado con una forma definida de pago
 - Un bill puede cambiar su forma definida de pago
 - A un bill se le puede cambiar la fecha de vencimiento
 - A un invoice se le puede asociar una lista de bills que sumen igual que el total del valor neto de todas las transacciones en el momento de crearla
 - Un bill se puede sustituir por una lista de otros bill que sumen lo mismo
 - La lista puede ser de 1:1
 - La lista puede ser de 1:varios
 - La lista puede ser de varios:1
 - La lista puede ser de varios:varios
 

 ---------------------------------------------------------------------------------------------------------
Invoice Unit Testing
 - Al añadir una factura CON INVOICEID se supone que estamos cargando desde la persistencia, luego el
 constructor ha de incluir TODOS los campos (bills...)
 